services:
  # Aplicação Flask com Gunicorn
  web_production:
    networks:
      - flask_network
    build:
      context: .
      dockerfile: Dockerfile.prod
    container_name: docker_poo_prod
    restart: unless-stopped
    ports:
      - "5095:5095"
    env_file: 
      - .env.prod
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5095/"]
      interval: 30s
      timeout: 10s
      retries: 3
    volumes:
      - ./logs:/app/logs
    mem_limit: 800m
    mem_reservation: 400m

networks:
  flask_network:
    driver: bridge